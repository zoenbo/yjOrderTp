/*
A JavaScript implementation of the Secure Hash Algorithm,SHA-1,as defined
in FIPS PUB 180-1
Version 2.1a Copyright Paul Johnston 2000 - 2002.
Other contributors: Greg Holt,Andrew Kepert,Ydnar,Lostinet
Distributed under the BSD License
See http://pajhome.org.uk/crypt/md5 for details.
*/
function sha1(s){return binb2hex(core_sha1(str2binb(s),s.length*8));}function core_sha1(x,len){x[len>>5]|=0x80<<(24-len%32);x[((len+64>>9)<<4)+15]=len;let w=[80],a=1732584193,b=-271733879,c=-1732584194,d=271733878,e=-1009589776;for(let i=0;i<x.length;i+=16){let oldA=a,oldB=b,oldC=c,oldD=d,oldE=e;for(let j=0;j<80;j++){w[j]=j<16?x[i+j]:rol(w[j-3]^w[j-8]^w[j-14]^w[j-16],1);let t=safe_add(safe_add(rol(a,5),sha1_ft(j,b,c,d)),safe_add(safe_add(e,w[j]),sha1_kt(j)));e=d;d=c;c=rol(b,30);b=a;a=t;}a=safe_add(a,oldA);b=safe_add(b,oldB);c=safe_add(c,oldC);d=safe_add(d,oldD);e=safe_add(e,oldE);}return [a,b,c,d,e];}function sha1_ft(t,b,c,d){if(t<20)return(b&c)|((~b)&d);if(t<40)return b^c^d;if(t<60)return(b&c)|(b&d)|(c&d);return b^c^d;}function sha1_kt(t){return(t<20)?1518500249:(t<40)?1859775393:(t<60)?-1894007588:-899497514;}function safe_add(x,y){let lsw=(x&0xFFFF)+(y&0xFFFF),msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF);}function rol(num,cnt){return(num<<cnt)|(num>>>(32-cnt));}function str2binb(str){let bin=[],mask=(1<<8)-1;for(let i=0;i<str.length*8;i+=8)bin[i>>5]|=(str.charCodeAt(i/8)&mask)<<(32-8-i%32);return bin;}function binb2hex(binArray){let hex_tab='0123456789abcdef',str='';for(let i=0;i<binArray.length*4;i++){str+=hex_tab.charAt((binArray[i>>2]>>((3-i%4)*8+4))&0xF)+hex_tab.charAt((binArray[i>>2]>>((3-i%4)*8))&0xF);}return str;}